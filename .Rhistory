ifelse(steps$last_completed_at=="","Unknown",steps$last_completed_at)
steps<-ifelse(steps$last_completed_at=="","Unknown",steps$last_completed_at)
steps<-cyber.security.1_step.activity
steps$last_completed_at<-ifelse(steps$last_completed_at=="","Unknown",steps$last_completed_at)
View(steps)
steps<-cyber.security.1_step.activity
steps$last_completed_at<-ifelse(steps$last_completed_at=="","DNF",steps$last_completed_at)
unique(steps$last_completed_at)
?as.POSIXct
as.POSIXct("2016-09-05 15:25:01 UTC", format="%Y-%m-%d %H:%M:%S")
as.POSIXct(steps$last_completed_at, format="%Y-%m-%d %H:%M:%S")
steps$last_completed_at<-as.POSIXct(steps$last_completed_at, format="%Y-%m-%d %H:%M:%S")
steps$first_visited_at<-as.POSIXct(steps$first_visited_at, format="%Y-%m-%d %H:%M:%S")
steps$first_visited_at
steps<-cyber.security.1_step.activity
steps$last_completed_at<-as.numeric(as.POSIXct(steps$last_completed_at, format="%Y-%m-%d %H:%M:%S"))/86400
steps$first_visited_at<-as.numeric(as.POSIXct(steps$first_visited_at, format="%Y-%m-%d %H:%M:%S"))/86400
stesteps$first_visited_at
steps$first_visited_at
time_taken<-data.frame(unique(steps$learner_id))
?mutate
steps %>%
select(learner_id)
steps %>%
select(learner_id)%>%
unique()
steps %>%
select(learner_id)%>%
distict()
steps %>%
select(learner_id)%>%
dlypr::distict()
steps %>%
select(learner_id)%>%
dplyr::distict()
steps %>%
select(learner_id)%>%
dplyr::distinct()
steps %>%
select(learner_id, first_visited_at)%>%
dplyr::distinct()
x<-steps %>%
select(learner_id)%>%
dplyr::distinct()%>%
time_taken<-data.frame(unique(steps$learner_id))
x<-steps %>%
select(learner_id)%>%
dplyr::distinct()
?filter
/in
?in
c(1,2,3)in c(2,2,2)
c(1,2,3) in c(2,2,2)
c(1,2,3) %in% c(2,2,2)
steps$
filter(steps, step==1 )
steps$
filter(steps, "step"==1 )
filter(steps, step_number==1 )
colnames(steps)
names_to_change<-colnames(steps)
names_to_change[2]<-"step_precise"#step is a function in R and so is harder to manipulate
colnames(steps)<-names_to_change
names_to_change
unique(steps$step_precise)
filter(steps, step_precise==1.1 )
time_taken
colnames(time_taken)
time_taken<-data.frame(unique(steps$learner_id), col="learner_id")
colnames(time_taken)
time_taken<-data.frame(unique(steps$learner_id), names="learner_id")
colnames(time_taken)
time_taken<-data.frame(unique(steps$learner_id), colnames="learner_id")
time_taken<-data.frame(unique(steps$learner_id), colnames="learner_id")
colnames(time_taken)
time_taken<-data.frame(learner_id=unique(steps$learner_id))
colnames(time_taken)
inner_join(time_taken, filter(steps, step_precise==1.1 ), by=learner_id)
inner_join(time_taken, filter(steps, step_precise==1.1 ), by=c("learner_id"))
inner_join(time_taken, filter(steps, step_precise==1.1 & step_precise==1.9 ), by=c("learner_id"))
unique(steps$step_precise)
steps$last_completed_at<-as.numeric(as.POSIXct(steps$last_completed_at, format="%Y-%m-%d %H:%M:%S"))/86400
steps$first_visited_at<-as.numeric(as.POSIXct(steps$first_visited_at, format="%Y-%m-%d %H:%M:%S"))/86400
names_to_change<-colnames(steps)
names_to_change[2]<-"step_precise"#step is a function in R and so is harder to manipulate
colnames(steps)<-names_to_change
time_taken<-data.frame(learner_id=unique(steps$learner_id))
inner_join(time_taken, steps, by=c("learner_id"))
right_join(time_taken, steps, by=c("learner_id"))
left_join(time_taken, steps, by=c("learner_id"))
group_by(steps, step_precise)
semi_join(time_taken, steps, by=c("learner_id"))
#load.project()
#tmp<-inner_join(cyber.security.1_enrolments,cyber.security.1_question.response, by=c("learner_id"))
steps<-cyber.security.1_step.activity
steps$last_completed_at<-as.numeric(as.POSIXct(steps$last_completed_at, format="%Y-%m-%d %H:%M:%S"))/86400
steps$first_visited_at<-as.numeric(as.POSIXct(steps$first_visited_at, format="%Y-%m-%d %H:%M:%S"))/86400
names_to_change<-colnames(steps)
names_to_change[2]<-"step_precise"#step is a function in R and so is harder to manipulate
colnames(steps)<-names_to_change
time_taken<-data.frame(learner_id=unique(steps$learner_id))
semi_join(time_taken, steps, by=c("learner_id"))
?semi_join
inner_join(time_taken, steps, by=c("learner_id"))
inner_join
?inner_join
?summarise_at
left_join(time_taken,
steps %>% group_by(learner_id) %>%
summarise_at(vars(-group_cols()), .funs = ~paste(unique(.), collapse ="_")) %>%
ungroup()
, byc("learner_id"))
left_join(time_taken,
steps %>% group_by(learner_id) %>%
summarise_at(vars(-group_cols()), .funs = ~paste(unique(.), collapse ="_")) %>%
ungroup()
, by=c("learner_id"))
q<-left_join(time_taken,
steps %>% group_by(learner_id) %>%
summarise_at(vars(-group_cols()), .funs = ~paste(unique(.), collapse ="_")) %>%
ungroup()
, by=c("learner_id"))
View(q)
unique(steps$step_precise)
time_taken
for (i in unique(steps$step_precise)){
time_taken<- left_join(time_taken, filter(steps, step_precise==i), by=c("learner_id"))
}
time_taken
dim(time_taken)
length(unique(steps$step_precise))
6*55
5*55
dim(time_taken)
paste(rep(colnames(steps)[-1], 55), rep(1:55,5))
paste(rep(colnames(steps)[-1], 55), sort(rep(1:55,5)))
colnames(time_taken)<-c("learner_id",paste(rep(colnames(steps)[-1], 55), sort(rep(1:55,5))))
time_taken
colnames(time_taken)<-c("learner_id",paste(rep(colnames(steps)[-1], 55), sort(rep(1:55,5)), sep = "_"))
time_taken
for (i in unique(steps$step_precise)){
time_taken<- left_join(time_taken, filter(steps, step_precise==i)[,c("first_visited_at","last_completed_at")], by=c("learner_id"))
}
time_taken<-data.frame(learner_id=unique(steps$learner_id))
for (i in unique(steps$step_precise)){
time_taken<- left_join(time_taken, filter(steps, step_precise==i)[,c("first_visited_at","last_completed_at")], by=c("learner_id"))
}
for (i in unique(steps$step_precise)){
time_taken<- left_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
}
dim(time_taken)
colnames(time_taken)<-c("learner_id",paste(rep(c("first_visited_at","last_completed_at"), 55), sort(rep(unique(steps$step_precise),2)), sep = "_"))
colnames(time_taken)
?sort
colnames(time_taken)<-c("learner_id",paste(rep(c("first_visited_at","last_completed_at"), 55), sort(rep(unique(steps$step_precise),2)), sep = "_"), method=unique(steps$step_precise))
colnames(time_taken)<-c("learner_id",paste(rep(c("first_visited_at","last_completed_at"), 55),rep(unique(steps$step_precise),2)), sep = "_")
colnames(time_taken)
time_taken<-data.frame(learner_id=unique(steps$learner_id))
for (i in unique(steps$step_precise)){
time_taken<- left_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
}
seq(2,54,2)
seq(3, 55,2)
test<-data.frame(c(1,2,3),c(2,2,2))
test2<-data.frame(c(1,2,3),c(2,2,2))
test[,1:2]-test2[,1:2]
test2<-data.frame(c(1,2,3),c(2,2,3))
test[,1:2]-test2[,1:2]
time_taken[,seq(3, 55,2)]-time_taken[,seq(2,54,2)]
new_time<-time_taken[,seq(3, 55,2)]-time_taken[,seq(2,54,2)]
colnames(new_time)<-unique(steps$step_precise)
colnames(new_time)
dim(time_taken)
new_time<-time_taken[,seq(3, 111,2)]-time_taken[,seq(2,110,2)]
colnames(new_time)<-unique(steps$step_precise)
colnames(new_time)
length(seq(3, 111,2))
new_time<-time_taken[,seq(4, 110,2)]-time_taken[,seq(3,110,2)]
colnames(new_time)<-unique(steps$step_precise[-length(steps$step_precise)])
colnames(new_time)<-unique(steps$step_precise)[-length(steps$step_precise)]
colnames(new_time)<-unique(steps$step_precise)[-55]
length(steps$step_precise)
unique_length<-unique(steps$step_precise)
unique_length
unique_length<-length(unique(steps$step_precise))
unique_length
colnames(new_time)<-unique(steps$step_precise)[-unique_length]
new_time
time_taken<-data.frame(learner_id=unique(steps$learner_id))
for (i in unique(steps$step_precise)){
time_taken<- left_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
}
dim(time_taken)
View(time_taken)
new_time<-time_taken[,seq(4, 110,2)]-time_taken[,seq(3,110,2)]
apply(new_time, MARGIN=1, var)
?apply
apply(new_time, MARGIN=1, var(na.rm=T))
apply(new_time, MARGIN=1, function(i){var(i,na.rm=T)})
id_variance<-apply(new_time, MARGIN=1, function(i){var(i,na.rm=T)})
variance<-apply(new_time, MARGIN=1, function(i){var(i,na.rm=T)})
id_variance<-data.frame(learner_idtime_taken[,"learner_id"], Var_reported=variance)
id_variance<-data.frame(learner_id=time_taken[,"learner_id"], Var_reported=variance)
View(id_variance)
unique(cyber.security.1_enrolments$fully_participated_at)
is.na(cyber.security.1_enrolments$fully_participated_at)
sum(is.na(cyber.security.1_enrolments$fully_participated_at))
is.null(cyber.security.1_enrolments$fully_participated_at)
View(cyber.security.1_enrolments$fully_participated_at)
View(cyber.security.1_enrolments)
enrolment<-cyber.security.1_enrolments
enrolment$fully_participated_at<-ifelse(cyber.security.1_enrolments$fully_participated_at=="",FALSE,TRUE)
id_variance %>%
left_join(enrolments[,c("learner_id", "fully_participated_at")], by=c("learner_id") )
id_variance %>%
left_join(enrolment[,c("learner_id", "fully_participated_at")], by=c("learner_id") )
id_variance<-id_variance %>%
left_join(enrolment[,c("learner_id", "fully_participated_at")], by=c("learner_id") )
View(id_variance)
cor(id_variance[,2:3])
id_variance<-data.frame(learner_id=time_taken[,"learner_id"], Var_reported=variance)
enrolment<-cyber.security.1_enrolments
enrolment$fully_participated_at<-ifelse(cyber.security.1_enrolments$fully_participated_at=="",0,1)
id_variance<-id_variance %>%
left_join(enrolment[,c("learner_id", "fully_participated_at")], by=c("learner_id") )
View(id_variance)
cor(id_variance[,2:3])
?cor
cor(id_variance[,2:3],na.rm=TRUE )
plot(id_variance$fully_participated_at, id_variance$Var_reported)
id_variance$Var_reported<-ifelse(id_variance$Var_reported==NA,-5, id_variance$Var_reported)
plot(id_variance$fully_participated_at, id_variance$Var_reported)
id_variance<-data.frame(learner_id=time_taken[,"learner_id"], Var_reported=variance)
enrolment<-cyber.security.1_enrolments
enrolment$fully_participated_at<-ifelse(cyber.security.1_enrolments$fully_participated_at=="",0,1)
id_variance<-id_variance %>%
left_join(enrolment[,c("learner_id", "fully_participated_at")], by=c("learner_id") )
View(id_variance)
id_variance$Var_reported<-ifelse(is.na(id_variance$Var_reported),-5, id_variance$Var_reported)
id_variance$Var_reported
plot(id_variance$fully_participated_at, id_variance$Var_reported)
hist(id_variance$Var_reported[,id_variance$fully_participated_at==1])
hist(id_variance$Var_reported[id_variance$fully_participated_at==1,])
hist(id_variance$Var_reported[id_variance$fully_participated_at==1])
hist(id_variance$Var_reported[id_variance$fully_participated_at==0])
id_variance<-data.frame(learner_id=time_taken[,"learner_id"], Var_reported=variance)
enrolment<-cyber.security.1_enrolments
enrolment$fully_participated_at<-ifelse(cyber.security.1_enrolments$fully_participated_at=="",0,1)
id_variance<-id_variance %>%
left_join(enrolment[,c("learner_id", "fully_participated_at")], by=c("learner_id") )
id_variance$Var_reported<-id_variance$Var_reported^2
id_variance$Var_reported<-ifelse(is.na(id_variance$Var_reported),-500, id_variance$Var_reported)
hist(id_variance$Var_reported[id_variance$fully_participated_at==1])
hist(id_variance$Var_reported[id_variance$fully_participated_at==0])
id_variance$Var_reported[id_variance$fully_participated_at==1]
id_variance$Var_reported[id_variance$fully_participated_at==0]
boxplot(id_variance$Var_reported[id_variance$fully_participated_at==1])
boxplot(id_variance$Var_reported[id_variance$fully_participated_at==0])
summary(id_variance$Var_reported[id_variance$fully_participated_at==1])
id_variance<-data.frame(learner_id=time_taken[,"learner_id"], Var_reported=variance)
enrolment<-cyber.security.1_enrolments
enrolment$fully_participated_at<-ifelse(cyber.security.1_enrolments$fully_participated_at=="",0,1)
id_variance<-id_variance %>%
left_join(enrolment[,c("learner_id", "fully_participated_at")], by=c("learner_id") )
id_variance$Var_reported<-ifelse(is.na(id_variance$Var_reported),-500, id_variance$Var_reported)
summary(id_variance$Var_reported[id_variance$fully_participated_at==1])
summary(id_variance$Var_reported[id_variance$fully_participated_at==0])
mean<-apply(new_time, MARGIN=1, function(i){mean(i,na.rm=T)})
mean_record<-apply(new_time, MARGIN=1, function(i){mean(i,na.rm=T)})
id_variance<-data.frame(learner_id=time_taken[,"learner_id"], Var_reported=variance, mean= mean_record)
enrolment<-cyber.security.1_enrolments
enrolment$fully_participated_at<-ifelse(cyber.security.1_enrolments$fully_participated_at=="",0,1)
id_variance<-id_variance %>%
left_join(enrolment[,c("learner_id", "fully_participated_at")], by=c("learner_id") )
View(id_variance)
id_variance<-data.frame(learner_id=time_taken[,"learner_id"], Var_reported=variance, mean= mean_record)
View(id_variance)
View(new_time)
dim(new_time)
dim(time_taken)
variance<-apply(new_time, MARGIN=1, function(i){var(i,na.rm=F)})
mean_record<-apply(new_time, MARGIN=1, function(i){mean(i,na.rm=F)})
length(variance)
dim(new_time)
id_variance<-data.frame(learner_id=time_taken[,"learner_id"], Var_reported=variance, mean= mean_record)
dim(id_variance)
enrolment<-cyber.security.1_enrolments
enrolment$fully_participated_at<-ifelse(cyber.security.1_enrolments$fully_participated_at=="",0,1)
id_variance<-id_variance %>%
left_join(enrolment[,c("learner_id", "fully_participated_at")], by=c("learner_id") )
dim(id_variance)
View(id_variance)
unique(time_taken[,"learner_id"])
length(unique(time_taken[,"learner_id"]))
time_taken<-data.frame(learner_id=unique(steps$learner_id))
dim(time_taken)
for (i in unique(steps$step_precise)){
time_taken<- left_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
}
dim(time_taken)
time_taken<-data.frame(learner_id=unique(steps$learner_id))
filter(steps, step_precise==1.1)[,c("learner_id","first_visited_at","last_completed_at")]
unique(filter(steps, step_precise==1.1)[,c("learner_id","first_visited_at","last_completed_at")][,1])
group_by(filter(steps, step_precise==1.1)[,c("learner_id","first_visited_at","last_completed_at")], learner_id)
distinct(filter(steps, step_precise==1.1)[,c("learner_id","first_visited_at","last_completed_at")])
#load.project()
#tmp<-inner_join(cyber.security.1_enrolments,cyber.security.1_question.response, by=c("learner_id"))
steps<-cyber.security.1_step.activity
View(steps)
unique(steps$step_number)
unique(steps$step)
#load.project()
#tmp<-inner_join(cyber.security.1_enrolments,cyber.security.1_question.response, by=c("learner_id"))
steps<-cyber.security.1_step.activity
steps$step<-str(step$step)
steps$step
steps$'step'<-str(step$step)
steps$step<-str(steps$step)
View(step)
View(steps)
#load.project()
#tmp<-inner_join(cyber.security.1_enrolments,cyber.security.1_question.response, by=c("learner_id"))
steps<-cyber.security.1_step.activity
names_to_change<-colnames(steps)
names_to_change[2]<-"step_precise"#step is a function in R and so is harder to manipulate
colnames(steps)<-names_to_change
View(steps)
steps$step_precise<-str(steps$step_precise)
View(steps)
#load.project()
#tmp<-inner_join(cyber.security.1_enrolments,cyber.security.1_question.response, by=c("learner_id"))
steps<-cyber.security.1_step.activity
names_to_change<-colnames(steps)
names_to_change[2]<-"step_precise"#step is a function in R and so is harder to manipulate
colnames(steps)<-names_to_change
str(steps$step_precise)
str(steps$step_precise)
steps$step_precise<-str(steps$step_precise)
#load.project()
#tmp<-inner_join(cyber.security.1_enrolments,cyber.security.1_question.response, by=c("learner_id"))
steps<-cyber.security.1_step.activity
names_to_change<-colnames(steps)
names_to_change[2]<-"step_precise"#step is a function in R and so is harder to manipulate
colnames(steps)<-names_to_change
steps$step_precise2<-str(steps$step_precise)
?mutate
transmute(steps,str(),keep="unused")
transmute(steps,step_precise=str(step_precise),keep="unused")
class(steps$step_precise)
steps$step_precise<-as.string(steps$step_precise)
steps$step_precise<-as.character(steps$step_precise)
steps
unique(steps$step_precise)
#load.project()
#tmp<-inner_join(cyber.security.1_enrolments,cyber.security.1_question.response, by=c("learner_id"))
steps<-cyber.security.1_step.activity
steps
steps[]<-lapply(cyber.security.2_step.activity, as.character)
#load.project()
#tmp<-inner_join(cyber.security.1_enrolments,cyber.security.1_question.response, by=c("learner_id"))
steps<-cyber.security.1_step.activity
names_to_change<-colnames(steps)
names_to_change[2]<-"step_precise"#step is a function in R and so is harder to manipulate
colnames(steps)<-names_to_change
steps$step_precise<-as.character(steps$step_precise)
unique(steps$step_precise)
class(steps$step_precise)
steps$step_precise<-ifelse(steps$step_number==10 & steps$week_number==1,"1.10",steps$step_precise )
steps$step_precise<-ifelse(steps$step_number==10 & steps$week_number==2,"2.10",steps$step_precise )
steps$step_precise<-ifelse(steps$step_number==10 & steps$week_number==3,"3.10",steps$step_precise )
steps$step_precise<-ifelse(steps$step_number==20 & steps$week_number==3,"3.10",steps$step_precise )
steps$last_completed_at<-as.numeric(as.POSIXct(steps$last_completed_at, format="%Y-%m-%d %H:%M:%S"))/86400
steps$first_visited_at<-as.numeric(as.POSIXct(steps$first_visited_at, format="%Y-%m-%d %H:%M:%S"))/86400
time_taken<-data.frame(learner_id=unique(steps$learner_id))
dim(time_taken)
steps$last_completed_at-steps$
for (i in unique(steps$step_precise)){
time_taken<- left_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
}
time_taken<-data.frame(learner_id=unique(steps$learner_id))
dim(time_taken)
steps$last_completed_at-steps$
for (i in unique(steps$step_precise)){
time_taken<- left_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
}
dim(time_taken)
for (i in unique(steps$step_precise)){
time_taken<- left_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
}
time_taken<-data.frame(learner_id=unique(steps$learner_id))
for (i in unique(steps$step_precise)){
time_taken<- left_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
}
dim(time_taken)
unique(filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")][,1])
unique(filter(steps, step_precise==1.1)[,c("learner_id","first_visited_at","last_completed_at")][,1])
dim(time_taken)
unique(steps$step_precise)
length(unique(steps$step_precise))
for (i in unique(steps$step_precise)){
length(unique(filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")][,1]))
#time_taken<- left_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
}
for (i in unique(steps$step_precise)){
print(length(unique(filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")][,1])))
#time_taken<- left_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
}
time_taken<-data.frame(learner_id=unique(steps$learner_id))
for (i in unique(steps$step_precise)){
time_taken<- all_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
}
?left_join
time_taken<-data.frame(learner_id=unique(steps$learner_id))
for (i in unique(steps$step_precise)){
time_taken<- inner_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
}
dim(time_taken)
time_taken<-data.frame(learner_id=unique(steps$learner_id))
dim(time_taken)
for (i in unique(steps$step_precise)){
time_taken<- inner_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
}
dim(time_taken)
time_taken<-data.frame(learner_id=unique(steps$learner_id))
for (i in unique(steps$step_precise)){
time_taken<- full_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
}
dim(time_taken)
time_taken<-data.frame(learner_id=unique(steps$learner_id))
for (i in unique(steps$step_precise)){
time_taken<- left_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
}
dim(time_taken)
time_taken<-data.frame(learner_id=unique(steps$learner_id))
time_taken<- left_join(time_taken, filter(steps, step_precise=="1.1")[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
dim(time_taken)
time_taken<-data.frame(learner_id=unique(steps$learner_id))
dim(time_taken)
time_taken<- left_join(time_taken, filter(steps, step_precise=="1.1")[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
time_taken<- left_join(time_taken, filter(steps, step_precise=="1.2")[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
dim(time_taken)
time_taken<- left_join(time_taken, filter(steps, step_precise=="1.3")[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
dim(time_taken)
time_taken<- left_join(time_taken, filter(steps, step_precise=="1.4")[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
dim(time_taken)
time_taken<- left_join(time_taken, filter(steps, step_precise=="1.5")[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
dim(time_taken)
time_taken<- left_join(time_taken, filter(steps, step_precise=="1.6")[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
dim(time_taken)
time_taken<- left_join(time_taken, filter(steps, step_precise=="1.7")[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
dim(time_taken)
time_taken<- left_join(time_taken, filter(steps, step_precise=="1.8")[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
dim(time_taken)
time_taken<- left_join(time_taken, filter(steps, step_precise=="1.9")[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
dim(time_taken)
time_taken<-data.frame(learner_id=unique(steps$learner_id))
for (i in unique(steps$step_precise)){
time_taken<- left_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
print(dim(time_taken))
print(i)
}
#load.project()
#tmp<-inner_join(cyber.security.1_enrolments,cyber.security.1_question.response, by=c("learner_id"))
steps<-cyber.security.1_step.activity
names_to_change<-colnames(steps)
names_to_change[2]<-"step_precise"#step is a function in R and so is harder to manipulate
colnames(steps)<-names_to_change
steps$step_precise<-as.character(steps$step_precise)
unique(steps$step_precise)
steps$step_precise<-ifelse(steps$step_number==10 & steps$week_number==1,"1.10",steps$step_precise )
steps$step_precise<-ifelse(steps$step_number==10 & steps$week_number==2,"2.10",steps$step_precise )
steps$step_precise<-ifelse(steps$step_number==10 & steps$week_number==3,"3.10",steps$step_precise )
steps$step_precise<-ifelse(steps$step_number==20 & steps$week_number==2,"2.20",steps$step_precise )
steps$step_precise<-ifelse(steps$step_number==20 & steps$week_number==3,"3.20",steps$step_precise )
steps$last_completed_at<-as.numeric(as.POSIXct(steps$last_completed_at, format="%Y-%m-%d %H:%M:%S"))/86400
steps$first_visited_at<-as.numeric(as.POSIXct(steps$first_visited_at, format="%Y-%m-%d %H:%M:%S"))/86400
time_taken<-data.frame(learner_id=unique(steps$learner_id))
for (i in unique(steps$step_precise)){
time_taken<- left_join(time_taken, filter(steps, step_precise==i)[,c("learner_id","first_visited_at","last_completed_at")], by=c("learner_id"))
print(dim(time_taken))
print(i)
}
dim(time_taken)
length(unique(steps$step_precise))
unique_length<-length(unique(steps$step_precise))
new_time<-time_taken[,seq(4, 121,2)]-time_taken[,seq(3,120,2)]
dim(new_time)
variance<-apply(new_time, MARGIN=1, function(i){var(i,na.rm=F)})
mean_record<-apply(new_time, MARGIN=1, function(i){mean(i,na.rm=F)})
length(variance)
id_variance<-data.frame(learner_id=unique(time_taken[,"learner_id"]), Var_reported=variance, mean= mean_record)
enrolment<-cyber.security.1_enrolments
enrolment$fully_participated_at<-ifelse(cyber.security.1_enrolments$fully_participated_at=="",0,1)
id_variance<-id_variance %>%
left_join(enrolment[,c("learner_id", "fully_participated_at")], by=c("learner_id") )
dim(id_variance)
View(id_variance)
summary(id_variance$Var_reported[id_variance$fully_participated_at==1])
summary(id_variance$Var_reported[id_variance$fully_participated_at==0])
variance<-apply(new_time, MARGIN=1, function(i){var(i,na.rm=T)})
mean_record<-apply(new_time, MARGIN=1, function(i){mean(i,na.rm=T)})
length(variance)
id_variance<-data.frame(learner_id=unique(time_taken[,"learner_id"]), Var_reported=variance, mean= mean_record)
id_variance<-id_variance %>%
left_join(enrolment[,c("learner_id", "fully_participated_at")], by=c("learner_id") )
View(id_variance)
summary(id_variance$Var_reported[id_variance$fully_participated_at==1])
summary(id_variance$Var_reported[id_variance$fully_participated_at==0])
boxplot(id_variance$Var_reported[id_variance$fully_participated_at==1])
boxplot(id_variance$Var_reported[id_variance$fully_participated_at==0])
hist(id_variance$Var_reported[id_variance$fully_participated_at==1])
hist(id_variance$Var_reported[id_variance$fully_participated_at==0])
